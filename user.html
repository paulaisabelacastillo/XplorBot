<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>XPLÃ˜R - User Profile</title>

<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        "primary": "#0da6f2",
        "background-light": "#f5f7f8",
        "background-dark": "#101c22",
      },
      fontFamily: {
        "display": ["Plus Jakarta Sans", "Noto Sans", "sans-serif"]
      },
      borderRadius: {
        "DEFAULT": "1rem",
        "lg": "2rem",
        "xl": "3rem",
        "full": "9999px"
      },
    },
  },
}
</script>

<style>
/* Additional styles */
#langMenu {
  position: absolute;
  right: 0;
  margin-top: 8px;
  width: 150px;
  background: white;
  border-radius: 0.5rem;
  overflow: hidden;
  border: 1px solid #ddd;
  display: none;
  z-index: 50;
}
#langMenu button {
  width: 100%;
  padding: 10px 12px;
  text-align: left;
  font-size: 14px;
}
#langMenu button:hover { background-color: #0da6f21a; }
.material-symbols-outlined {
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
}
.show-section {
    display: block;
}
.hide-section {
    display: none;
}
</style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200">
<div class="relative flex min-h-screen w-full flex-col">

  <header class="sticky top-0 z-50 flex justify-center border-b border-gray-200/50 bg-background-light/80 px-4 py-3 backdrop-blur-sm dark:border-gray-800/50 dark:bg-background-dark/80 sm:px-8 md:px-10">
    <div class="flex w-full max-w-7xl items-center justify-between">
      <div class="flex items-center gap-8">
        <div class="flex items-center gap-2 text-slate-800 dark:text-white">
          <span class="material-symbols-outlined text-primary text-3xl">explore</span>
          <h2 class="text-xl font-bold tracking-tighter">XPLÃ˜R</h2>
        </div>
        <nav class="hidden items-center gap-6 lg:flex">
          <a class="nav-link text-sm font-medium text-slate-700 hover:text-primary dark:text-slate-300 dark:hover:text-primary" href="index.html" data-en="HOME" data-es="INICIO">HOME</a>
          <a class="nav-link text-sm font-medium text-slate-700 hover:text-primary dark:text-slate-300 dark:hover:text-primary" href="explore.html" data-en="EXPLORE" data-es="EXPLORA">EXPLORE</a>
          <a class="nav-link text-sm font-medium text-slate-700 hover:text-primary dark:text-slate-300 dark:hover:text-primary" href="play.html" data-en="PLAY" data-es="JUEGA">PLAY</a>
          <a class="nav-link text-sm font-medium text-slate-700 hover:text-primary dark:text-slate-300 dark:hover:text-primary" href="learn.html" data-en="LEARN" data-es="APRENDE">LEARN</a>
          <a class="nav-link text-sm font-medium text-slate-700 hover:text-primary dark:text-slate-300 dark:hover:text-primary" href="earn.html" data-en="EARN" data-es="GANA">EARN</a>
          <a class="nav-link text-sm font-medium text-slate-700 hover:text-primary dark:text-slate-300 dark:hover:text-primary" href="about.html" data-en="ABOUT US" data-es="NOSOTROS">ABOUT US</a>
        </nav>
      </div>

 <div class="flex items-center gap-2">
  <a href="login.html" id="signupBtn" class="hidden min-w-[84px] md:flex cursor-pointer items-center justify-center overflow-hidden rounded-full bg-primary px-4 h-10 text-sm font-bold text-white transition-colors hover:bg-primary/90" data-en="LOG IN" data-es="INICIAR SESIÃ“N">LOG IN</a>
  
  <div class="relative">
    <button id="langBtn" class="flex h-10 w-10 cursor-pointer items-center justify-center overflow-hidden rounded-full bg-slate-200/60 text-slate-700 transition-colors hover:bg-slate-200 dark:bg-slate-800/60 dark:text-slate-300 dark:hover:bg-slate-800">
      <span class="material-symbols-outlined text-xl">language</span>
    </button>
    <div id="langMenu">
      <button data-lang="en">English ðŸ‡ºðŸ‡¸</button>
      <button data-lang="es">EspaÃ±ol ðŸ‡µðŸ‡¦</button>
    </div>
  </div>

        <a href="user.html" id="profileBtn" class="flex h-10 w-10 cursor-pointer items-center justify-center overflow-hidden rounded-full bg-slate-200/60 text-slate-700 transition-colors hover:bg-slate-200 dark:bg-slate-800/60 dark:text-slate-300 dark:hover:bg-slate-800">
          <span class="material-symbols-outlined text-xl">person</span>
        </a>
      </div>
    </div>
  </header>
  
  <main class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 flex-grow">
<div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
<aside class="lg:col-span-4 xl:col-span-3 space-y-8">
<div class="p-6 bg-white dark:bg-background-dark/50 rounded-lg flex flex-col items-center text-center shadow-md">
<div class="relative mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-primary/20">
<span id="userInitial" class="text-4xl font-bold text-primary">A</span> 
</div>
<p id="userNameDisplay" class="text-gray-900 dark:text-white text-xl font-bold leading-tight tracking-[-0.015em]">Loading...</p>
<p id="userEmailDisplay" class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal">Loading email...</p>
</div>
<nav class="p-4 bg-white dark:bg-background-dark/50 rounded-lg shadow-md">
<ul class="space-y-1" id="profileNav">
<li>
<a id="accountSettingsLink" class="nav-item flex items-center gap-3 rounded-md px-4 py-2.5 text-sm font-bold bg-primary/20 text-primary cursor-pointer" 
   href="#account" data-en="Account Settings" data-es="ConfiguraciÃ³n de Cuenta" 
   onclick="showSection('accountContent', this)">
<span class="material-symbols-outlined text-base">person</span>
<span class="nav-text">Account Settings</span>
</a>
</li>
<li>
<a id="privacyLink" class="nav-item flex items-center gap-3 rounded-md px-4 py-2.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-primary/10 hover:text-primary transition-colors duration-200 cursor-pointer" 
   href="#privacy" data-en="Privacy" data-es="Privacidad" 
   onclick="showSection('privacyContent', this)">
<span class="material-symbols-outlined text-base">lock</span>
<span class="nav-text">Privacy</span>
</a>
</li>
<li>
<a id="preferencesLink" class="nav-item flex items-center gap-3 rounded-md px-4 py-2.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-primary/10 hover:text-primary transition-colors duration-200 cursor-pointer" 
   href="#preferences" data-en="Preferences" data-es="Preferencias" 
   onclick="showSection('preferencesContent', this)">
<span class="material-symbols-outlined text-base">settings</span>
<span class="nav-text">Preferences</span>
</a>
</li>
<li>
<a id="logoutLink" class="nav-item flex items-center gap-3 rounded-md px-4 py-2.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-red-500/10 hover:text-red-500 transition-colors duration-200 cursor-pointer" data-en="Logout" data-es="Cerrar SesiÃ³n">
<span class="material-symbols-outlined text-base">logout</span>
<span class="nav-text">Logout</span>
</a>
</li>
</ul>
</nav>
</aside>

<div class="lg:col-span-8 xl:col-span-9">

<section id="accountContent" class="show-section">
    <div class="flex flex-wrap justify-between gap-3 mb-8">
        <div class="flex min-w-72 flex-col gap-2">
            <p data-key="account_settings_title" class="text-gray-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">Account Settings</p>
            <p data-key="account_settings_subtitle" class="text-gray-600 dark:text-gray-400 text-base font-normal leading-normal">Manage your personal information, security, and preferences.</p>
        </div>
    </div>
    <div class="bg-white dark:bg-background-dark/50 rounded-lg p-6 shadow-md">
        <div class="flex flex-col">
            <details id="personalInfoDetails" class="flex flex-col border-b border-b-gray-200 dark:border-b-gray-700 py-3 group" open="">
                <summary class="flex cursor-pointer items-center justify-between gap-6 py-2 list-none">
                    <div class="flex flex-col">
                        <p data-key="personal_info_title" class="text-gray-900 dark:text-white text-base font-bold leading-normal">Personal Information</p>
                        <p data-key="personal_info_subtitle" class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal hidden sm:block">Update your name and email address.</p>
                    </div>
                    <span class="material-symbols-outlined text-gray-900 dark:text-white group-open:rotate-180 transition-transform duration-300">expand_more</span>
                </summary>
                <div class="pt-6 pb-2 space-y-6">
                    <form id="updateNameForm">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label data-key="full_name_label" class="block text-sm font-medium text-gray-800 dark:text-white/80 mb-2" for="fullNameInput">Full Name</label>
                                <input id="fullNameInput" class="w-full bg-background-light dark:bg-background-dark/20 border-gray-300 dark:border-gray-700 rounded-md text-gray-900 dark:text-white placeholder:text-gray-400 focus:ring-primary focus:border-primary" type="text" required/>
                            </div>
                            <div>
                                <label data-key="email_label" class="block text-sm font-medium text-gray-800 dark:text-white/80 mb-2" for="emailInput">Email Address</label>
                                <input id="emailInput" class="w-full bg-background-light dark:bg-background-dark/20 border-gray-300 dark:border-gray-700 rounded-md text-gray-900 dark:text-white placeholder:text-gray-400 focus:ring-primary focus:border-primary" type="email" readonly/>
                            </div>
                        </div>
                        <p id="nameSuccessMessage" data-key="name_success_msg" class="text-sm font-medium text-green-500 mt-2 hidden">Name updated successfully!</p>
                        <div class="flex justify-end mt-4">
                            <button type="submit" data-key="save_changes_btn" class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-6 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors">
                                <span class="truncate">Save Changes</span>
                            </button>
                        </div>
                    </form>
                </div>
            </details>

            <details id="securityDetails" class="flex flex-col border-b border-b-gray-200 dark:border-b-gray-700 py-3 group">
                <summary class="flex cursor-pointer items-center justify-between gap-6 py-2 list-none">
                    <div class="flex flex-col">
                        <p data-key="security_title" class="text-gray-900 dark:text-white text-base font-bold leading-normal">Security</p>
                        <p data-key="security_subtitle" class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal hidden sm:block">Change your account password.</p>
                    </div>
                    <span class="material-symbols-outlined text-gray-900 dark:text-white group-open:rotate-180 transition-transform duration-300">expand_more</span>
                </summary>
                <div class="pt-6 pb-2 space-y-6">
                    <form id="updatePasswordForm">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label data-key="current_password_label" class="block text-sm font-medium text-gray-800 dark:text-white/80 mb-2" for="currentPassword">Current Password</label>
                                <input id="currentPassword" class="w-full bg-background-light dark:bg-background-dark/20 border-gray-300 dark:border-gray-700 rounded-md text-gray-900 dark:text-white placeholder:text-gray-400 focus:ring-primary focus:border-primary" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" type="password" required/>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label data-key="new_password_label" class="block text-sm font-medium text-gray-800 dark:text-white/80 mb-2" for="newPassword">New Password</label>
                                <input id="newPassword" class="w-full bg-background-light dark:bg-background-dark/20 border-gray-300 dark:border-gray-700 rounded-md text-gray-900 dark:text-white placeholder:text-gray-400 focus:ring-primary focus:border-primary" placeholder="Enter new password" type="password" required/>
                            </div>
                            <div>
                                <label data-key="confirm_password_label" class="block text-sm font-medium text-gray-800 dark:text-white/80 mb-2" for="confirmPassword">Confirm New Password</label>
                                <input id="confirmPassword" class="w-full bg-background-light dark:bg-background-dark/20 border-gray-300 dark:border-gray-700 rounded-md text-gray-900 dark:text-white placeholder:text-gray-400 focus:ring-primary focus:border-primary" placeholder="Confirm new password" type="password" required/>
                            </div>
                        </div>
                        <p id="passwordErrorMessage" class="text-sm font-medium text-red-500 mt-2 hidden"></p>
                        <p id="passwordSuccessMessage" data-key="password_success_msg" class="text-sm font-medium text-green-500 mt-2 hidden">Password updated successfully! Please log in again.</p>

                        <div class="flex justify-end mt-4">
                            <button type="submit" data-key="update_password_btn" class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-6 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors">
                                <span class="truncate">Update Password</span>
                            </button>
                        </div>
                    </form>
                </div>
            </details>
        </div>
    </div>
</section>

<section id="privacyContent" class="hide-section">
    <div class="flex flex-wrap justify-between gap-3 mb-8">
        <div class="flex min-w-72 flex-col gap-2">
            <p data-key="privacy_title" class="text-gray-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">Privacy</p>
            <p data-key="privacy_subtitle" class="text-gray-600 dark:text-gray-400 text-base font-normal leading-normal">Control how we use and protect your data.</p>
        </div>
    </div>
    <div class="bg-white dark:bg-background-dark/50 rounded-lg p-6 shadow-md">
        <div class="flex flex-col space-y-4">
             <div class="flex items-center justify-between py-2 border-b dark:border-gray-700 last:border-b-0">
                <div class="flex flex-col">
                    <p data-key="data_sharing_title" class="text-gray-900 dark:text-white text-base font-bold">Data Sharing</p>
                    <p data-key="data_sharing_subtitle" class="text-gray-600 dark:text-gray-400 text-sm">Allow the use of your activity data to improve the experience.</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" value="" class="sr-only peer" checked>
                    <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-primary dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                </label>
            </div>
            
            <div class="flex items-center justify-between py-2 border-b dark:border-gray-700 last:border-b-0">
                <div class="flex flex-col">
                    <p data-key="email_marketing_title" class="text-gray-900 dark:text-white text-base font-bold">Marketing Emails</p>
                    <p data-key="email_marketing_subtitle" class="text-gray-600 dark:text-gray-400 text-sm">Receive newsletters and special offers.</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" value="" class="sr-only peer">
                    <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-primary dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                </label>
            </div>
            
            <div class="pt-4">
                <p data-key="delete_account_warning" class="text-sm text-red-600 dark:text-red-400 mb-2">Deleting your account is permanent and cannot be undone.</p>
                <button data-key="delete_account_btn" class="flex min-w-[180px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-6 bg-red-600 text-white text-sm font-bold leading-normal tracking-[0.015em] hover:bg-red-500 transition-colors">
                    <span class="truncate">Delete my Account</span>
                </button>
            </div>
        </div>
    </div>
</section>

<section id="preferencesContent" class="hide-section">
    <div class="flex flex-wrap justify-between gap-3 mb-8">
        <div class="flex min-w-72 flex-col gap-2">
            <p data-key="preferences_title" class="text-gray-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">Preferences</p>
            <p data-key="preferences_subtitle" class="text-gray-600 dark:text-gray-400 text-base font-normal leading-normal">Adjust application display and behavior options.</p>
        </div>
    </div>
    <div class="bg-white dark:bg-background-dark/50 rounded-lg p-6 shadow-md">
        <div class="pt-2 pb-2 space-y-6">
            
            <div class="flex flex-col">
                <label data-key="language_label" class="block text-sm font-medium text-gray-800 dark:text-white/80 mb-2" for="languageSelect">Language</label>
                <select class="w-full sm:max-w-xs bg-background-light dark:bg-background-dark/20 border-gray-300 dark:border-gray-700 rounded-md text-gray-900 dark:text-white focus:ring-primary focus:border-primary" id="languageSelect">
                    <option data-key="lang_en" value="en">English</option>
                    <option data-key="lang_es" value="es">EspaÃ±ol</option>
                    <option value="zh">ä¸­æ–‡</option>
                </select>
            </div>
            
            <div class="flex justify-end pt-4">
                <button data-key="save_preferences_btn" class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-6 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors">
                    <span class="truncate">Save Preferences</span>
                </button>
            </div>
        </div>
    </div>
</section>

</div>
</div>
</main>

  <footer class="w-full bg-background-light dark:bg-background-dark">
    <div class="mx-auto max-w-7xl px-4 py-8 sm:px-8">
      <div class="flex flex-col items-center justify-between gap-4 border-t border-slate-200 pt-8 dark:border-slate-800 sm:flex-row">
        <p class="text-sm text-slate-600 dark:text-slate-400">Â© 2024 XPLÃ˜R. All Rights Reserved.</p>
        <div class="text-sm text-slate-600 dark:text-slate-400">
          Follow us: <span class="font-semibold text-slate-800 dark:text-slate-200">@xplor.pty</span>
        </div>
      </div>
    </div>
  </footer>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script>
    // ==========================================================
    // 1. Firebase Configuration - USE YOUR CREDENTIALS
    // ==========================================================
    const firebaseConfig = {
        apiKey: "AIzaSyDevEFBLiwL61zJT_yv2-jcktd-slR1C5I",
        authDomain: "xplor-5df4a.firebaseapp.com",
        projectId: "xplor-5df4a",
        storageBucket: "xplor-5df4a.firebasestorage.app",
        messagingSenderId: "207109387595",
        appId: "1:207109387595:web:5646b123c433db5c01a4ce",
        measurementId: "G-TNGYB5V05R"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    
    // 2. DOM Elements and Variables
    const userNameDisplay = document.getElementById('userNameDisplay');
    const userEmailDisplay = document.getElementById('userEmailDisplay');
    const userInitialElement = document.getElementById('userInitial');
    const fullNameInput = document.getElementById('fullNameInput');
    const emailInput = document.getElementById('emailInput');
    const logoutLink = document.getElementById('logoutLink');
    const signupBtn = document.getElementById('signupBtn');
    const profileBtn = document.getElementById('profileBtn');

    const updateNameForm = document.getElementById('updateNameForm');
    const nameSuccessMessage = document.getElementById('nameSuccessMessage');

    const updatePasswordForm = document.getElementById('updatePasswordForm');
    const currentPassword = document.getElementById('currentPassword');
    const newPassword = document.getElementById('newPassword');
    const confirmPassword = document.getElementById('confirmPassword');
    const passwordErrorMessage = document.getElementById('passwordErrorMessage');
    const passwordSuccessMessage = document.getElementById('passwordSuccessMessage');
    
    // SPA Structure Elements
    const allContentSections = document.querySelectorAll('.lg\\:col-span-8 section');
    const allNavItems = document.querySelectorAll('#profileNav .nav-item'); 
    
    let currentUser = null; 

    // ==========================================================
    // 3. TRANSLATION LOGIC (ENGLISH/SPANISH) - UPDATED
    // ==========================================================
    const translations = {
        en: {
            // Navbar and Footer (from data-en)
            "HOME": "HOME", "EXPLORE": "EXPLORE", "PLAY": "PLAY", "LEARN": "LEARN", "EARN": "EARN", "ABOUT US": "ABOUT US", 
            "LOG IN": "LOG IN", "INICIAR SESIÃ“N": "LOG IN", 

            // Sidebar - UPDATED
            "Account Settings": "Account Settings", "Privacy": "Privacy", "Preferences": "Preferences", "Cerrar SesiÃ³n": "Logout", "Logout": "Logout",

            // Main Content (Account Settings)
            "account_settings_title": "Account Settings",
            "account_settings_subtitle": "Manage your personal information, security, and preferences.",
            "personal_info_title": "Personal Information",
            "personal_info_subtitle": "Update your name and email address.",
            "full_name_label": "Full Name",
            "email_label": "Email Address",
            "save_changes_btn": "Save Changes",
            "name_success_msg": "Name updated successfully!",
            
            "security_title": "Security",
            "security_subtitle": "Change your account password.",
            "current_password_label": "Current Password",
            "new_password_label": "New Password",
            "confirm_password_label": "Confirm New Password",
            "update_password_btn": "Update Password",
            "password_success_msg": "Password updated successfully! Please log in again.",

            // Main Content (Privacy) - NEW
            "privacy_title": "Privacy",
            "privacy_subtitle": "Control how we use and protect your data.",
            "data_sharing_title": "Data Sharing",
            "data_sharing_subtitle": "Allow the use of your activity data to improve the experience.",
            "email_marketing_title": "Marketing Emails",
            "email_marketing_subtitle": "Receive newsletters and special offers.",
            "delete_account_warning": "Deleting your account is permanent and cannot be undone.",
            "delete_account_btn": "Delete my Account",

            // Main Content (Preferences) - UPDATED
            "preferences_title": "Preferences",
            "preferences_subtitle": "Adjust application display and behavior options.",
            "language_label": "Language",
            "save_preferences_btn": "Save Preferences",

             // Language Options
             "lang_en": "English",
             "lang_es": "Spanish"
        },
        es: {
            // Navbar and Footer (from data-es)
            "HOME": "INICIO", "EXPLORE": "EXPLORA", "PLAY": "JUEGA", "LEARN": "APRENDE", "EARN": "GANA", "ABOUT US": "NOSOTROS", 
            "LOG IN": "INICIAR SESIÃ“N", "INICIAR SESIÃ“N": "INICIAR SESIÃ“N", 

            // Sidebar - UPDATED
            "Account Settings": "ConfiguraciÃ³n de Cuenta", "Privacy": "Privacidad", "Preferences": "Preferencias", "Cerrar SesiÃ³n": "Cerrar SesiÃ³n", "Logout": "Cerrar SesiÃ³n",

            // Main Content (Account Settings)
            "account_settings_title": "ConfiguraciÃ³n de Cuenta",
            "account_settings_subtitle": "Administra tu informaciÃ³n personal, seguridad y preferencias.",
            "personal_info_title": "InformaciÃ³n Personal",
            "personal_info_subtitle": "Actualiza tu nombre y correo electrÃ³nico.",
            "full_name_label": "Nombre Completo",
            "email_label": "Correo ElectrÃ³nico",
            "save_changes_btn": "Guardar Cambios",
            "name_success_msg": "Â¡Nombre actualizado con Ã©xito!",

            "security_title": "Seguridad",
            "security_subtitle": "Cambia la contraseÃ±a de tu cuenta.",
            "current_password_label": "ContraseÃ±a Actual",
            "new_password_label": "Nueva ContraseÃ±a",
            "confirm_password_label": "Confirmar Nueva ContraseÃ±a",
            "update_password_btn": "Actualizar ContraseÃ±a",
            "password_success_msg": "Â¡ContraseÃ±a actualizada con Ã©xito! Por favor, vuelve a iniciar sesiÃ³n.",

            // Main Content (Privacy) - NEW
            "privacy_title": "Privacidad",
            "privacy_subtitle": "Controla cÃ³mo usamos y protegemos tus datos.",
            "data_sharing_title": "Compartir Datos",
            "data_sharing_subtitle": "Permitir el uso de tus datos de actividad para mejorar la experiencia.",
            "email_marketing_title": "Emails de Marketing",
            "email_marketing_subtitle": "Recibir boletines y ofertas especiales.",
            "delete_account_warning": "Eliminar tu cuenta es permanente y no se puede deshacer.",
            "delete_account_btn": "Eliminar mi Cuenta",


            // Main Content (Preferences) - UPDATED
            "preferences_title": "Preferencias",
            "preferences_subtitle": "Ajusta las opciones de visualizaciÃ³n y comportamiento de la aplicaciÃ³n.",
            "language_label": "Idioma",
            "save_preferences_btn": "Guardar Preferencias",

            // Language Options
            "lang_en": "English",
            "lang_es": "EspaÃ±ol"
        }
    };
    
    // SET DEFAULT LANGUAGE TO ENGLISH
    let currentLang = 'en'; 

    function setLanguage(lang) {
        currentLang = lang;
        document.documentElement.lang = lang;
        
        // 1. Translate Navbar and items with data-en/data-es
        document.querySelectorAll('[data-en], [data-es]').forEach(element => {
            const translationKey = element.getAttribute(`data-${lang}`);
            if (translationKey) {
                element.textContent = translationKey;
            }
        });

        // 2. Translate main content (using data-key and nav-text)
        document.querySelectorAll('[data-key]').forEach(element => {
            const key = element.getAttribute('data-key');
            if (translations[lang] && translations[lang][key]) {
                 // Use textContent for most elements (h1, p, label)
                element.textContent = translations[lang][key];
            }
        });

        // 3. Translate <span> elements inside menu (sidebar)
        document.querySelectorAll('.nav-text').forEach(element => {
            const parentLink = element.closest('a');
            if (parentLink) {
                // If the element has data-en/data-es, use it
                const key = parentLink.getAttribute(`data-${lang}`);
                if(key) {
                    element.textContent = key;
                }
            }
        });
        
    }
    
    // â­ï¸ NEW SPA NAVIGATION LOGIC
    function showSection(sectionId, element) {
        // Hide all sections
        document.querySelectorAll('section').forEach(section => {
            section.classList.remove('show-section');
            section.classList.add('hide-section');
        });

        // Show the selected section
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.classList.remove('hide-section');
            targetSection.classList.add('show-section');
        }

        // Remove active class from all navigation items
        allNavItems.forEach(item => {
            item.classList.remove('bg-primary/20', 'text-primary', 'font-bold');
            item.classList.add('text-gray-600', 'dark:text-gray-400', 'hover:bg-primary/10', 'hover:text-primary', 'font-medium');
        });

        // Apply active class to the clicked element
        if (element) {
            element.classList.add('bg-primary/20', 'text-primary', 'font-bold');
            element.classList.remove('text-gray-600', 'dark:text-gray-400', 'hover:bg-primary/10', 'hover:text-primary', 'font-medium');
        }
    }


    // Handle language change from the dropdown menu
    document.getElementById('langBtn').addEventListener('click', () => {
        document.getElementById('langMenu').style.display = document.getElementById('langMenu').style.display === 'block' ? 'none' : 'block';
    });

    document.querySelectorAll('#langMenu button').forEach(button => {
        button.addEventListener('click', (e) => {
            const lang = e.target.getAttribute('data-lang');
            setLanguage(lang);
            document.getElementById('langMenu').style.display = 'none';
        });
    });

    // Handle language change from the preferences selector
    const languageSelect = document.getElementById('languageSelect');
    if(languageSelect) {
        languageSelect.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });
    }

    // Load default language on start
    document.addEventListener('DOMContentLoaded', () => {
        setLanguage(currentLang);
        
        // Load the selected language in the <select>
        if(languageSelect) {
            languageSelect.value = currentLang;
        }

        // Handle URL hash to show the correct section on load
        const hash = window.location.hash.substring(1);
        const accountLink = document.getElementById('accountSettingsLink');

        if (hash) {
            const targetLink = document.querySelector(`#profileNav a[href="#${hash}"]`);
            const targetContentId = hash + 'Content';
            if (targetLink) {
                showSection(targetContentId, targetLink);
            } else if (hash === 'account' && accountLink) {
                showSection('accountContent', accountLink);
            }
        } else if (accountLink) {
            // Ensure Account Settings is active by default
            showSection('accountContent', accountLink);
        }
    });

    // ==========================================================
    // 4. FIREBASE AND PROFILE FUNCTIONALITY LOGIC
    // ==========================================================

    auth.onAuthStateChanged((user) => {
        if (user) {
            currentUser = user;
            
            // Hide "LOG IN" button and show profile button
            signupBtn.classList.add('hidden');
            profileBtn.classList.remove('hidden');

            // Load user data
            const email = user.email || "User";
            const initial = email.charAt(0).toUpperCase();
            
            const name = user.displayName || email.split('@')[0]; 

            userEmailDisplay.textContent = email;
            userInitialElement.textContent = initial;
            userNameDisplay.textContent = name;
            
            // Fill configuration inputs
            fullNameInput.value = name; 
            emailInput.value = email;
            
        } else {
            // User NOT logged in: Redirect to Login and protect the route
            window.location.href = "/login.html"; 
        }
    });

    // â­ï¸ LOGOUT (Maintained)
    logoutLink.addEventListener('click', async (e) => {
        e.preventDefault();
        try {
            await auth.signOut();
            // onAuthStateChanged will detect the change and redirect to /login.html
        } catch (error) {
            console.error("Error logging out:", error);
            alert("There was an error logging out.");
        }
    });

    // â­ï¸ UPDATE NAME (Maintained)
    updateNameForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        nameSuccessMessage.classList.add('hidden');
        if (!currentUser) return;

        const newName = fullNameInput.value;

        try {
            await currentUser.updateProfile({
                displayName: newName
            });

            userNameDisplay.textContent = newName;
            
            nameSuccessMessage.classList.remove('hidden');
            setLanguage(currentLang); // Reload success message text
            setTimeout(() => nameSuccessMessage.classList.add('hidden'), 3000);

        } catch (error) {
            console.error("Error updating name:", error);
            alert("Error updating name.");
        }
    });
    
    // â­ï¸ CHANGE PASSWORD (Maintained)
    updatePasswordForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        passwordErrorMessage.classList.add('hidden');
        passwordSuccessMessage.classList.add('hidden');
        if (!currentUser) return;

        const oldPass = currentPassword.value;
        const newPass = newPassword.value;
        const confPass = confirmPassword.value;

        // Error messages in English since default language is now English
        if (newPass !== confPass) {
            passwordErrorMessage.textContent = currentLang === 'en' ? "The new password and its confirmation do not match." : "La nueva contraseÃ±a y su confirmaciÃ³n no coinciden.";
            passwordErrorMessage.classList.remove('hidden');
            return;
        }

        if (newPass.length < 6) {
            passwordErrorMessage.textContent = currentLang === 'en' ? "The new password must be at least 6 characters long." : "La nueva contraseÃ±a debe tener al menos 6 caracteres.";
            passwordErrorMessage.classList.remove('hidden');
            return;
        }

        const credential = firebase.auth.EmailAuthProvider.credential(currentUser.email, oldPass);

        try {
            await currentUser.reauthenticateWithCredential(credential);
            await currentUser.updatePassword(newPass);

            passwordSuccessMessage.classList.remove('hidden');
            setLanguage(currentLang); // Reload success message text

            currentPassword.value = '';
            newPassword.value = '';
            confirmPassword.value = '';

            setTimeout(async () => {
                await auth.signOut();
            }, 3000);

        } catch (error) {
            let message = currentLang === 'en' ? "Error changing password. Make sure the Current Password is correct." : "Error al cambiar la contraseÃ±a. AsegÃºrate de que la ContraseÃ±a Actual sea correcta.";
            if (error.code === 'auth/wrong-password') {
                message = currentLang === 'en' ? "The Current Password is incorrect." : "La ContraseÃ±a Actual es incorrecta.";
            } else if (error.code === 'auth/weak-password') {
                 message = currentLang === 'en' ? "The new password must be at least 6 characters long." : "La nueva contraseÃ±a debe tener al menos 6 caracteres.";
            } else if (error.code === 'auth/requires-recent-login') {
                 message = currentLang === 'en' ? "Your session expired. Please log in again and repeat the process." : "Tu sesiÃ³n expirÃ³. Por favor, vuelve a iniciar sesiÃ³n y repite el proceso.";
            }
            console.error("Error changing password:", error);
            passwordErrorMessage.textContent = message;
            passwordErrorMessage.classList.remove('hidden');
        }
    });
</script>
</body>
</html>